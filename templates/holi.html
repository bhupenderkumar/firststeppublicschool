<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>First Step Public School | Holi Registration</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script>
       
    </script>
</head>


<body class="h-screen">
    {% include 'header.html' %}
    
    <div class="container mx-auto py-12">
        <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
            <h1 class="text-3xl text-center mb-6">Holi Registration(Only for Outside Childrens)</h1>
            <form id="myForm" action="/holi" method="POST" enctype="multipart/form-data">
                <div class="mb-4">
                    <label for="class_name" class="text-gray-700 block mb-2">Your Child Class</label>
                    <select id="class_name" name="class_name"  class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        <option value="">Select Class</option>
                        {% for class_name in classes %}
                        <option value="{{ class_name }}">{{ class_name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="mb-4">
                    <label for="child_name" class="text-gray-700 block mb-2">Your Child's Name</label>
                    <input id="child_name" name="child_name" type="text" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                </div>
                <div class="mb-4">
                    <label for="children_attending" class="text-gray-700 block mb-2">Children Attending Name:</label>
                    <input id="children_attending" name="children_attending" type="text" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                </div>
                <div class="flex flex-wrap mb-4">
                    <!-- Child's Date of Birth -->
                    <div class="w-full md:w-1/2 md:pr-2 mb-4">
                        <label for="child_dob" class="text-gray-700 block mb-2">Child's Date of Birth</label>
                        <input id="child_dob" name="child_dob" type="date" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                    </div>
                    
                    <!-- Age Display -->
                    <div class="w-full md:w-1/2 md:pl-2 mb-4">
                        <label for="child_age" class="text-gray-700 block mb-2">Child's Age</label>
                        <input id="child_age" name="child_age" type="text" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" readonly>
                    </div>
                </div>

                <!-- Parent's Phone Number -->
                <div class="mb-4">
                    <label for="parent_phone" class="text-gray-700 block mb-2">Parent's Phone Number</label>
                    <input id="parent_phone" required name="parent_phone" type="tel" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                    <span id="phoneError" class="text-red-500 hidden">Please enter a valid phone number</span>
                </div>
        
                <!-- Emergency Contact Number -->
                <div class="mb-4">
                    <label for="emergency_contact" class="text-gray-700 block mb-2">Emergency Contact Number</label>
                    <input id="emergency_contact" required name="emergency_contact" type="tel" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                    <span id="emergencyError" class="text-red-500 hidden">Please enter a valid phone number</span>
                </div>
        
                <!-- Submit Button -->
                <div class="flex justify-end">
                    <button type="submit" class="animate__animated animate__bounceIn bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">Submit</button>
                </div>
            </form>
        </div>
    </div>
    {% include 'footer.html' %}
</body>


<script>
    // Mobile number validation
    function validatePhone(phoneInput, errorSpan) {
        const phoneRegex = /^[0-9]{10}$/;
        if (!phoneRegex.test(phoneInput.value)) {
            errorSpan.classList.remove('hidden');
            return false;
        } else {
            errorSpan.classList.add('hidden');
            return true;
        }
    }

    // Form submission handler
    document.getElementById('myForm').addEventListener('submit', function(event) {
        const parentPhoneInput = document.getElementById('parent_phone');
        const emergencyPhoneInput = document.getElementById('emergency_contact');
        const parentErrorSpan = document.getElementById('phoneError');
        const emergencyErrorSpan = document.getElementById('emergencyError');

        // Validate both phone numbers
        const parentValid = validatePhone(parentPhoneInput, parentErrorSpan);
        const emergencyValid = validatePhone(emergencyPhoneInput, emergencyErrorSpan);

        // Prevent form submission if any phone number is invalid
        if (!parentValid || !emergencyValid) {
            event.preventDefault();
        }
    });
</script>
<script>
    // Calculate age from date of birth
    function calculateAge(dateOfBirth) {
        var today = new Date();
        var birthDate = new Date(dateOfBirth);
        var years = today.getFullYear() - birthDate.getFullYear();
        var months = today.getMonth() - birthDate.getMonth();
        if (months < 0 || (months === 0 && today.getDate() < birthDate.getDate())) {
            years--;
            months += 12;
        }
        var days = today.getDate() - birthDate.getDate();
        if (days < 0) {
            var prevMonthLastDay = new Date(today.getFullYear(), today.getMonth(), 0).getDate();
            days += prevMonthLastDay;
            months--;
        }
        return [years, months, days];
    }

    // Update age display
    function updateAgeDisplay() {
        var dobInput = document.getElementById('child_dob');
        var ageInput = document.getElementById('child_age');
        var dob = dobInput.value;
        var age = calculateAge(dob);
        ageInput.value = age[0] + " years, " + age[1] + " months, " + age[2] + " days";
    }

    // Event listener for date of birth change
    document.getElementById('child_dob').addEventListener('change', updateAgeDisplay);
</script>

</html>
